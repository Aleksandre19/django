{% extends "base.html" %}
{% load static %}
{% block content %}
    {% if request.user.is_authenticated %} <!-- User is authenticated -->
        
        <!-- Videos of the day -->
        <section class="section-wrapper mt-5">
            <div class="content-wrapper container-fluid">

                <!--Section title -->
                <h3 class='example-title titles'>
                    <i class="fas fa-solid fa-video titles-icon mr-2"></i>
                    Video<span class="plural d-none d-md-inline-block">s</span> of the day
                </h3>

                <!-- Video content -->
                <div class="row no-gutters example-video-wrapper mt-4 justify-content-center" >
                    {% for day_video in day_videos %}  
                        {% if forloop.counter == 1 %} 
                            <div class="col-12 col-md-4">
                        {% else %}
                            <div class="col-4 d-none d-md-block">
                        {% endif %}
                            <!-- Video -->
                            <div class="embed-responsive embed-responsive-16by9 position-relative ">                           
                                <iframe class="embed-responsive-item" src="{{ day_video.content }}" allowfullscreen></iframe>                          
                            </div>

                            <!-- Video's Description -->
                            <div class="card-bg card position-relative">
                                <p class="container-fluid mt-3 position-relative">           
                                    {{ day_video.description }}   
                                <p>
                            </div>

                        </div>  
                    {% endfor %}

                </div>
            </div>
        </section>

        <!-- Uppcoming event -->
        <section class="section-wrapper mt-5">
            <div class="content-wrapper container-fluid">
                
                <h3 class="example-title titles">
                    <i class="fas fa-redo-alt titles-icon pr-3"></i>
                    Upcoming Event
                </h3>

                <div class="row mt-4 no-gutters uppcoming-row">
                    <div class="col-12 col-lg-6 md-event-desc">

                        <!-- Event's Title -->
                        <h3 class="ml-3 pt-3 event-title example-title titles">
                            Summery of the year 2020
                        </h3>

                        <!-- Event's Description -->
                        <p class="mt-3 ml-1 container-fluid">
                            During this event I will summarize generally 
                            a healthcare situation in 2020.
                            Before a 24 hours of event's start you as a subscriber will 
                            recive a link on your email to join the event.
                        </p>

                    </div>

                    <!-- Timer's Block -->
                    <div class="col-12 col-lg-6 align-self-center">
                        <table class="table table-borderless">
                            <!-- Time -->
                            <thead class="timer event-table-head">
                                <tr>
                                    <td id="days">23 :</td>
                                    <td id="houres">24 :</td>
                                    <td id="minutes">14 :</td>
                                    <td id="seconds">06</td>
                                </tr>
                            </thead> 
                    
                            <!-- Time's Units -->
                            <tbody class="text-white font-italic text-left small event-table-body">
                                <tr>
                                    <td class="pr-3">Days</td>
                                    <td class="pr-4">Houres</td>
                                    <td class="pr-4">Minutes</td>
                                    <td>Seconds</td>
                                </tr>
                            </tbody>  
                        </table>

                    </div>
                </div>
            </div>
        </section>


        <!-- Top slanted line bg -->
        <div class="top-and-bottom-block-bg gray-section-top-bg mt-5"></div>

        <!-- My List Section -->
        <section class="row no-gutters gray-section">
            <div class="col-12">
                <div class='section-wrapper'>

                    <h3 class="container-fluid titles mt-4">
                        <i class="fas fa-th-list titles-icon pr-2"></i>
                        My List
                    </h3>
                    <hr class="video-title-devider">

                    <div class='row no-gutters'>
                        <div class='col-0 col-lg-1 d-none d-lg-block align-self-center'>
                            <a href='#' class='desk-video-switchwer' data-direction='left' id='left'>
                                <i class="fas fa-chevron-left"></i>
                            </a>
                        </div>

                        <div class='col-12 col-lg-10'>
                            <div class="video-slider-owerflow-hidden" id="my-list">
                                <div class="sliders-container">

                                    <!-- Looping a MyList videos by user -->
                                    {% for mylist_video in mylist_videos %}
                                        {% for video in videos %}
                                            {% if mylist_video.video == video %}

                                                <div class="slide">
                                            
                                                    <!-- Title  -->
                                                    <h3 class="mt-2 bycat-title"> 
                                                        <a href="{% url 'single_video' video.id %}" class="video-title ">
                                                             {{ video.title }} 
                                                        </a>
                                                    </h3>
                                                        
                                                    <div class="embed-responsive embed-responsive-16by9 position-relative mt-4">

                                                        <!-- Vidoe frame -->
                                                        <iframe class="embed-responsive-item" src="{{ video.content }}" allowfullscreen></iframe>
                            
                                                        <!-- Action Button -->
                                                        <div class="action-buttons-container">

                                                            <!--  Add to my list -->
                                                            <div class="action-button" data-bs-toggle="tooltip" 
                                                                 data-bs-placement="top" title="My List">
                                                                <a href="{% url 'action_buttons' %}?page_url={{request.get_full_path}}&video_id={{ video.id }}&action=mylist">
                                                                    
                                                                    {% if video == mylist_video.video %}
                                                                        <i class="added_in_list fas fa-plus-square"></i>
                                                                    {% else %}
                                                                        <i class="fas fa-plus-square"></i>
                                                                    {% endif %}
                                                                    
                                                                </a>
                                                            </div>
                                                            
                                                            <!-- Like -->
                                                            <div class="action-button" data-bs-toggle="tooltip" 
                                                                 data-bs-placement="top" title="Like">
                                                                <!-- Checking if a user has already liked current video -->
                                                                {% if video in videos_in_likes %}
                                                                    <i class="added_in_list fas fa-check"></i>
                                                                {% else %}
                                                                    <a href="{% url 'action_buttons' %}?page_url={{request.get_full_path}}&video_id={{ video.id }}&action=like" 
                                                                        class="">
                                                                        <i class="far fa-thumbs-up"></i>
                                                                    </a>
                                                                {% endif %}
                                                                <!-- Total likes -->
                                                                <small class=" action-buttons-value">   
                                                                    {% if video.liked == None %}
                                                                        ( 0 )
                                                                    {% else %}
                                                                        (+ {{ video.liked }} )
                                                                    {% endif %}
                                                                </small>
                                                            </div>

                                                            <!-- Watched -->
                                                            <div class="watched-value action-button" data-bs-toggle="tooltip" 
                                                                 data-bs-placement="top" title="Watched">
                                                                <a href="#">
                                                                    <i class="far fa-eye"></i>
                                                                </a><small class="action-buttons-value">(247)</small>
                                                            </div>

                                                        </div>
                                                       
                                                    </div>

                                                    <!-- Video's Description -->
                                                    <p class="container-fluid mt-3 position-relative">
                                                        {{ video.description }}
                                                    <p>
            
                                                </div>
                                            {% endif %}
                                        {% endfor %}
                                    {% endfor %}
                                </div>
                            </div>
                        </div>
                        
                        <div class='col-0 col-lg-1 d-none d-lg-block align-self-center'>
                            <a href='#' class='desk-video-switchwer float-right' data-direction='right' id='right'>
                                <i class="fas fa-chevron-right"></i>
                            </a>
                        </div>
                    </div>

                </div>
            </div>
        </section>

        <!-- Bottom slanted line bg -->
        <div class="top-and-bottom-block-bg gray-section-bottom-bg"></div>
         
        <!-- Sections by categories -->
        {% for category in categories %}

            <!-- Top slanted line bg -->
            {% if forloop.counter0|divisibleby:2 %}
                <div class="top-and-bottom-block-bg white-section-top-bg"></div>
                <section class="row no-gutters bg-white">
            {% else %}
                <div class="top-and-bottom-block-bg gray-section-top-bg"></div>
                <section class="row no-gutters gray-section">
            {% endif %}
                <div class="col-12">
                    <div class='section-wrapper'>
                        
                        <!-- Category title -->
                        <h3 class="container-fluid titles mt-4">
                            <img src="{{ MEDIA_URL }}/icons/{{category.name}}-icon.png" 
                            width="45px" class="pr-2" alt="Anatomy's Icon">
                            {{ category.name }}
                        </h3>
                        <hr class="video-title-devider">

                        <div class='row no-gutters'>

                            <!-- Slider left arrow -->
                            <div class='col-0 col-lg-1 d-none d-lg-block align-self-center'>
                                <a href='#' class='desk-video-switchwer' data-direction='left' id='left'>
                                    <i class="fas fa-chevron-left"></i>
                                </a>
                            </div>

                            <!-- Sliders area -->
                            <div class='col-12 col-lg-10'>
                                <div class="video-slider-owerflow-hidden" id="{{ category.name.lower }}">
                                    <div class="sliders-container">
                                        {% for video_by_category in videos_by_categories %}
                                            {% if video_by_category.category.name == category.name %}

                                                <!-- Slide -->
                                                <div class="slide">
                                                    
                                                    <!-- Single video title -->
                                                    <h3 class="mt-2 bycat-title"> 
                                                        <a href="{% url 'single_video' video_by_category.id %}" 
                                                            class="video-title "> {{ video_by_category.title }} 
                                                        </a>
                                                    </h3>
                                                        
                                                    <div class="embed-responsive embed-responsive-16by9 position-relative mt-4">             <!-- Video's Frame -->
                                                        
                                                        <!-- Video frame -->
                                                        <iframe class="embed-responsive-item" src="{{ video_by_category.content }}" 
                                                                allowfullscreen>
                                                        </iframe>
                            
                                                        <!-- Action Buttons -->
                                                        <div class="action-buttons-container">

                                                            <!--  Add to my list -->
                                                            <div class="action-button" data-bs-toggle="tooltip" 
                                                                data-bs-placement="top" title="My List">
                                                                <a href="{% url 'action_buttons' %}?page_url={{request.get_full_path}}&video_id={{ video_by_category.id }}&action=mylist">
                                                                    
                                                                    {% if video_by_category in videos_in_mylist %}
                                                                        <i class="added_in_list fas fa-plus-square"></i>
                                                                    {% else %}
                                                                        <i class="fas fa-plus-square"></i>
                                                                    {% endif %}
                                                                    
                                                                </a>
                                                            </div>
                                                            
                                                            <!-- Like -->
                                                            <div class="action-button" data-bs-toggle="tooltip" 
                                                                data-bs-placement="top" title="Like">

                                                                <!-- Checking if a user has already liked current video -->
                                                                {% if video_by_category in videos_in_likes %}
                                                                    <i class="added_in_list fas fa-check"></i>
                                                                {% else %}
                                                                    <a href="{% url 'action_buttons' %}?page_url={{request.get_full_path}}&video_id={{ video_by_category.id }}&action=like" 
                                                                        class="">
                                                                        <i class="far fa-thumbs-up"></i>
                                                                    </a>
                                                                {% endif %}
                                                                
                                                            
                                                                <!-- Total like -->
                                                                <small class=" action-buttons-value">   
                                                                    {% if video_by_category.liked == None %}
                                                                        ( 0 )
                                                                    {% else %}
                                                                        (+ {{ video_by_category.liked }} )
                                                                    {% endif %}
                                                                </small>
                                                            </div>

                                                            <!-- Watched -->
                                                            <div class="watched-value action-button" data-bs-toggle="tooltip" 
                                                                data-bs-placement="top" title="Watched">
                                                                <a href="#">
                                                                    <i class="far fa-eye"></i>
                                                                </a><small class="action-buttons-value">(247)</small>
                                                            </div>   
                                                        </div>
                                                    </div>

                                                    <!-- Video's Description -->
                                                    <p class="container-fluid mt-3 position-relative">
                                                        {{ video_by_category.description }}
                                                    <p>
            
                                                </div>
                                            {% endif %}
                                        {% endfor %}
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Slider right arrow-->
                            <div class='col-0 col-lg-1 d-none d-lg-block align-self-center'>
                                <a href='#' class='desk-video-switchwer float-right' data-direction='right' id='right'>
                                    <i class="fas fa-chevron-right"></i>
                                </a>
                            </div>

                        </div>
                    </div>
                </div>
            </section>

            <!-- Bottom slanted line bg -->
            {% if forloop.counter0|divisibleby:2 %}
                <div class="top-and-bottom-block-bg white-section-bottom-bg"></div>
            {% else %}
                 <div class="top-and-bottom-block-bg gray-section-bottom-bg"></div>
            {% endif %}
        {% endfor %}
        
        <div class="div-for-bottom-margin"> &nbsp; </div> 

        <!-- Scripts related to this sections -->
        <script src="{% static 'js/slider.js' %}"></script>
        {% comment %} <script src="{% static 'js/calendar.js' %}"></script> {% endcomment %}
        <script>
            // Initialing a calendar's function
            diasferoTimer(new Date("Dec 15, 2022 15:37:25").getTime());
        </script>

    {% else %} <!-- User in not authenticated -->
        
        <!-- Hero section --> 
        <section class="h-100 hero-section">
            <div class="row h-100 hero-section-content no-gutters">

                <div class="col-md-12 col-lg-6 align-self-center">
                    <h1 class="hero-text-bold text-white"> 
                        Tips From Doctor Diana <br> About <span>Healthcare</span>
                    </h1>
                
                    <p class="hero-paragraph mt-4"> 
                        More than one hundred videos about weight loss,
                        Tibetian medicine, diseases, physiology and more...
                    </p>
                    
                    <form action="{% url 'cards' %}" class="get-access-form">
                        <div class="row align-items-center no-gutters"  style="height: 65px;">
                            <div class="col">
                                <input type="text" class="get-access-input form-control" name="search">
                            </div>
                            <div class="col-3">
                                <button type="submit" class="get-access-btn btn btn-primary ml-2 wel-btn">
                                    <span class="d-none d-md-inline-block">Get</span> Access
                                </button>
                            </div>
                        </div>
                    </form>             

                </div>

                <div class="col-lg-6 d-none d-lg-block align-self-end">
                    <img src="{{ MEDIA_URL }}/img/lg/diana-img.png" 
                        alt="Doctor Diana" class="diana-img float-right" />
                </div>

            </div>
        </section>

        <!-- Video examples section -->
        <section class="section-wrapper mt-5">
            <div class="content-wrapper container-fluid">
                <!--Section title -->
                <h3 class='example-title titles'>
                    <i class="fas fa-solid fa-video titles-icon mr-2"></i>
                    Video Example<span class="plural d-none d-md-inline-block">s</span>
                </h3>

                <!-- Video examples -->
                <div class="row no-gutters example-video-wrapper mt-4 justify-content-center" >
                    {% for welcoming_video in welcoming_videos %}  
                        {% if forloop.counter == 1 %} 
                            <div class="col-12 col-md-4">
                        {% else %}
                            <div class="col-4 d-none d-md-block">
                        {% endif %}
                            <!-- Video -->
                            <div class="embed-responsive embed-responsive-16by9 position-relative ">                           
                                <iframe class="embed-responsive-item" src="{{ welcoming_video.content }}" allowfullscreen></iframe>                          
                            </div>

                            <!-- Video's Description -->
                            <div class="card-bg card position-relative">
                                <p class="container-fluid mt-3 position-relative">           
                                    {{ welcoming_video.description }}   
                                <p>
                            </div>

                        </div>  
                    {% endfor %}

                </div>
            </div>
        </section>
        
        <!-- Subscription section -->
        <section class="section-wrapper mt-5 mb-5">
            <div class="content-wrapper container-fluid">
                <h3 class="sub-title titles"> 
                    <i class="fas fa-user-edit titles-icon mr-2"></i>
                    <span> subscription </span>
                </h3>


                <div class="subs-cards-wrapper mt-4 rounded-lg shadow-sm">
                
                    <!-- Subscription text -->
                    <div class="subs-desc-bg">
                        <p class="subscription-description">
                            During my active medical practice I collected and documented videos
                            there you can get known for many aspect of the healthcare. 
                            Such are  Weight loss,  Tibetan medicine, Food problems, Physiology,
                            Anatomy, Meditation and more. By subscription you will get fully access
                            to this video colection and to the future events or webinars.
                        </p>
                    </div>
                    
                    <!-- Mobile subscription -->
                    <nav class="cards-nav d-md-none mt-5"> <!-- Cards link -->
                        <div class="nav nav-tabs cards-menu justify-content-center" id="nav-tab" role="tablist">
                            <a class="nav-item nav-link" id="nav-home-tab" data-toggle="tab"
                                href="#nav-home" role="tab" aria-controls="nav-home" aria-selected="true">
                                1 Month
                            </a>

                            <a class="nav-item nav-link active " id="nav-profile-tab" data-toggle="tab"
                            href="#nav-profile" role="tab" aria-controls="nav-profile" aria-selected="false">
                            6 Months
                            </a>
                            
                            <a class="nav-item nav-link last-card-nav-link" id="nav-contact-tab" data-toggle="tab"
                            href="#nav-contact" role="tab" aria-controls="nav-contact" aria-selected="false">
                            1 Year
                            </a>
                        </div>
                    </nav>
                    <!-- Mobile card's content -->
                    <div class="tab-content d-md-none bg-white rounded-lg shadow-sm" id="nav-tabContent">

                        {% for card in cards %}
                            
                            {% if forloop.counter == 2 %}
                                <div class="tab-pane fade show active" id="{{ card.tab_class }}" role="tabpanel" aria-labelledby="{{ card.tab_aria }}">
                            {% else %}
                                <div class="tab-pane fade" id="{{ card.tab_class }}" role="tabpanel" aria-labelledby="{{ card.tab_aria }}">
                            {% endif %}
                            
                                <div class="cards-content">


                                    <!-- Saving -->
                                    <p class="cards-saving mt-3"> 
                                        Save 
                                        <span> {{ card.saving }} </span> 
                                        Euros 
                                    </p>

                                    <!-- Price -->
                                    <div class="cards-price">
                                        <strong> {{ card.price }} </strong>
                                    </div>

                                    <!-- Currency -->
                                    <div class="cards-currency">
                                        <span>{{ card.currency }}</span>
                                    </div>

                                    <!-- Card Description -->
                                    <p class="cards-desc mt-3 ml-3 mr-3">{{ card.description }}</p>

                                    <!-- A form to submit a price and a stripe price id -->
                                    <form action="{% url 'checkout' %}" method="POST">
                                        {% csrf_token %}
                                        
                                        <input type="hidden" name="price" value="{{ card.price }}">
                                        <input type="hidden" name="stripe_plan_id" 
                                            value="{{ card.stripe_plan_id }}">
                                            
                                        <!-- Submit button -->
                                        <div class="cards-choose-btn-wrapper">
                                            <button type="button" class="btn btn-outline-success btn-lg mb-4">Choose a plan</button>
                                        </div>
                                    
                                    </form>    

                                </div>

                            </div>
                        {% endfor %}
                        
                    </div>

                    <!-- Tablets and above subscription -->
                    <div class="row no-gutters d-none d-md-flex mt-5 pb-5 justify-content-center">             
                        {% for card in cards %}
                            <div class="col-4">
                            <!-- If a offering is checked in admin so scaling up the card in size -->
                            {% if card.offering %}
                                <div class="cards-content home-desk-card" id="active-card">
                            {% else %}
                                <div class="cards-content home-desk-card">
                            {% endif %}

                                    <!-- Card's Duration  -->
                                    <p class=" cards-months-length text-uppercase text-center pt-4">
                                        {{ card.duration }} 
                                    </p>

                                    <!-- Savinng -->
                                    <p class="cards-saving mt-2"> 
                                        Save 
                                        <span> {{ card.saving }} </span> 
                                        Euros 
                                    </p>

                                    <!-- Price -->
                                    <div class="cards-price">
                                        <strong> {{ card.price }} </strong>
                                    </div>

                                    <!-- Currency -->
                                    <div class="cards-currency">
                                        <span>{{card.currency }}</span>
                                    </div>

                                    <!-- Card Description -->
                                    <p class="cards-desc fst-italic mt-3 ml-3 mr-3">{{ card.description }}</p>

                                    <!-- A form to submit a price and a stripe price id -->
                                    <form action="{% url 'checkout' %}" method="POST">
                                        {% csrf_token %}
                                        
                                        <input type="hidden" name="price" value="{{ card.price }}">
                                        <input type="hidden" name="stripe_plan_id" 
                                            value="{{ card.stripe_plan_id }}">
                                            
                                        <!-- Submit button -->
                                        <div class="cards-choose-btn-wrapper">
                                            <button type="button" class="btn btn-outline-success btn-lg mb-4">Choose a plan</button>
                                        </div>
                                    
                                    </form>    

                                </div>
                            </div>
                        {% endfor %}                  
                    </div>   
                </div>
            </div>
        </section>

        
        <!-- Top slanted line bg -->
        <div class="top-and-bottom-block-bg gray-section-top-bg"></div> 

        <!-- FAQ section -->
        <section class="gray-section">
            <div class="section-wrapper container-fluid">
                <!-- FAQ Title -->
                <h3 class="titles pt-2"> 
                    <i class="fas fa-th-list titles-icon mr-2"></i>
                        <span class="d-none d-md-inline-block">
                        Frequently Asked Questions
                    </span>
                    <span class="d-md-none"> FAQ </span>
                </h3>
                <hr/>
                
                <!-- FAQ 1 -->
                <div class="faq-1 mb-3">
                    <p class="faq-questions-p">
                        <a class="btn faq-questions" data-toggle="collapse" href="#faq-1" role="button" aria-expanded="false" aria-controls="faq-1">
                            What is included in subscription?
                        </a>
                    </p>
                    <div class="collapse mb-3" id="faq-1">
                        <div class="card card-body">
                            In subscription included a access to all videos, events and webinars. 
                        </div>
                    </div>
                </div>
                <!-- END a FAQ 1 -->

                <!-- FAQ 2 -->
                <div class="faq-2 mb-3">
                    <p class="faq-questions-p">
                        <a class="btn faq-questions" data-toggle="collapse" href="#faq-2" role="button" aria-expanded="false" aria-controls="faq-2">
                            When can I cancel a subscription?
                        </a>
                    </p>
                    <div class="collapse mb-3" id="faq-2">
                        <div class="card card-body">
                            A subscription you can cancell any time.
                        </div>
                    </div>
                </div>
                <!-- END a FAQ 2 -->

                <!-- FAQ 3 -->
                <div class="faq-3 mb-3">
                    <p class="faq-questions-p">
                        <a class="btn faq-questions" data-toggle="collapse" href="#faq-3" role="button" aria-expanded="false" aria-controls="faq-3">
                            How can I pay?
                        </a>
                    </p>
                    <div class="collapse mb-3" id="faq-3">
                        <div class="card card-body">
                            You can pay with a bank card. 
                        </div>
                    </div>
                </div>
                <!-- END a FAQ 3-->

                <!-- FAQ 4 -->
                <div class="faq-4">
                    <p class="faq-questions-p">
                        <a class="btn faq-questions" data-toggle="collapse" href="#faq-4" role="button" aria-expanded="false" aria-controls="faq-4">
                            May I have private consultation?
                        </a>
                    </p>
                    <div class="collapse  mb-3" id="faq-4">
                        <div class="card card-body">
                            Yes you can have it. In order to have a private consultation you have to contact me at - doctordiana@diasfero.com
                        </div>
                    </div>
                </div>
                <!-- END a FAQ 4 -->
            </div>
        </section>

        <!-- Bottom slanted line bg -->
        <div class="top-and-bottom-block-bg gray-section-bottom-bg mb-5"></div>

    {% endif %}
{% endblock %}

{% block bottom_extra_js %}
    <script>
        let page = 'home';
    </script>
{% endblock %}

